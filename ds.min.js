/*! dialog-system by ZHAO Xudong, html5beta.com 2015-02-02 */
!function(a){function b(b){function c(a){var b=this;this.init(a),this.defs.open&&(this.show(),this.defs.timer&&(this.handler=setTimeout(function(){b.hide()},this.defs.timer)))}function d(a,d,e){var f,g,h=(new Date).getTime();return b("body").append('<div id="'+h+'" style="position:fixed;left:0;top:0;opacity:0;filter:alpha(opacity=0);z-index:-1"><div style="max-width:100%"><span class="ds-content">'+b.dsOption.typeHtml[d?d:"default"]+a+c.prototype.buildBtns(e||[])+"</span></div></div>"),f=b("#"+h+" .ds-content").width(),g=b("#"+h+" .ds-content").height(),b("#"+h).remove(),{cw:f,ch:g}}if(!b)throw new Error("no jquery object!");b.dsOption={indexCounter:250,defaultWidth:300,defaultTimer:4e3,defaultTitle:"Info",defaultConfirmBtnHtml:'<span class="ds-pointer ds-btn ds-btn-green">OK</span>',defaultCancelBtnHtml:'<span class="ds-pointer ds-btn ds-btn-red ds-mgl">Cancel</span>',defaultTop:40,defaults:{modal:!1,closeText:"close",timer:0,css:{},type:"default",show:"show",showParam:null,hide:"hide",hideParam:null,animateSpeed:0,msg:"",open:!0,title:"",btns:[],hasCloseBtn:!0,selfDestroy:!1,beforeShow:null,afterShow:null,beforeHide:null,afterHide:null},closeHtml:"&times;",typeHtml:{"default":"",info:'<i class="ds-info ds-type-unit">i</i>',warn:'<i class="ds-warn ds-type-unit">!</i>',error:'<i class="ds-error ds-type-unit">&Chi;</i>',ok:'<i class="ds-ok ds-type-unit">&radic;</i>'}},c.prototype.init=function(a){var c=this.defs=b.extend({},b.dsOption.defaults,a),d=this.id=(new Date).getTime(),e=this.zIndex=++b.dsOption.indexCounter,f=this;b("body").append('<span style="z-index:'+(e+1)+'" class="ds-wrap ds-type-'+c.dsType+' ds-hide" id="ds-unit-'+d+'">'+(c.title?'<span class="ds-head ds-block"><span class="ds-head-content ds-iblock">'+c.title+"</span>"+(c.hasCloseBtn?'<span class="ds-btn-close ds-close">'+b.dsOption.closeHtml+"</span>":"")+"</span>":"")+'<span class="ds-inner"><span class="ds-content">'+b.dsOption.typeHtml[c.type]+c.msg+"</span>"+f.buildBtns(c.btns)+"</span>"+(c.title?"":c.hasCloseBtn?'<span class="ds-btn-close ds-close">'+b.dsOption.closeHtml+"</span>":"")+"</span>"),this.dom=b("#ds-unit-"+this.id),this.dom.css(c.css),this.dom.on("click",".ds-close",function(){clearTimeout(f.handler),f.hide()}),c.btns.length&&this.dom.find(".ds-btns").children().each(function(a){b(this).click(function(){c.btns[a].callback.call(f)})}),c.modal&&(b("body").append('<div class="ds-overlay ds-hide" id="ds-overlay-'+d+'" style="z-index:'+e+'"></div>'),this.overlay=b("#ds-overlay-"+this.id))},c.prototype.buildBtns=function(a){for(var b,c=a.length,d=0,e="";c>d;d++)b=a[d],e+=b.html;return e?'<span class="ds-block ds-btns">'+e+"</span>":""},c.prototype.destroy=function(){this.dom.off("click","**"),this.dom.remove(),this.overlay&&this.overlay.remove(),delete this.defs,delete this.id,delete this.dom,delete this.overlay},c.prototype.showCallback=function(){this.afterShow&&this.afterShow()},c.prototype.hideCallback=function(){this.dom.addClass("ds-hide"),this.afterHide&&this.defs.afterHide.call(th),this.defs.selfDestroy&&this.destroy()},c.prototype.show=function(){var a=this.defs.show,b=this;this.overlay&&this.overlay.removeClass("ds-hide"),this.defs.beforeShow&&this.defs.beforeShow.call(this),"animate"===a?this.dom.removeClass("ds-hide").animate(this.defs.showParam,this.defs.animateSpeed,function(){b.showCallback()}):this.dom.removeClass("ds-hide")[a](this.defs.animateSpeed,function(){b.showCallback()})},c.prototype.hide=function(){var a=this.defs.hide,b=this;this.defs.beforeHide&&this.defs.beforeHide.call(this),this.overlay&&this.overlay.addClass("ds-hide"),"animate"===a?this.dom.animate(this.defs.hideParam,this.defs.animateSpeed,function(){b.hideCallback()}):this.dom[a](this.defs.animateSpeed,function(){b.hideCallback()})},b.ds={},b.ds.ds=function(d,e){var f=b(a),g=f.width(),h=f.height(),i=b("body"),j=(i.height(),f.scrollTop()),k=b.dsOption,d=b.extend({},d),l=d.width?d.width:k.defaultWidth,m="id"+(new Date).getTime(),n=0,o=0,p=0,q={},r=d.type,s=b.extend([],d.btns,e.btns);return l=l>g?g:l,p=(g-l)/2,b.inArray(e.dsType,["dialog","popup"])>-1&&(i.append('<div id="'+m+'" style="position:fixed;left:0;top:0;opacity:0;filter:alpha(opacity=0);z-index:-1"><div style="width:'+l+'px"><div class="ds-content">'+k.typeHtml[r?r:"default"]+d.msg+c.prototype.buildBtns(s)+"</div></div></div>"),n=b("#"+m).height(),b("#"+m).remove(),o=(h-n)/2+j,o=h>n?o:j+20),q=b.extend({top:o,left:p,position:"absolute",width:l},d.css,e.css),new c(b.extend(d,{timer:d.timer||0,type:d.type||"default",msg:d.msg},e,{css:q}))},b.ds.popup=function(a,c,d,e){return b.isPlainObject(a)&&(e=a,a=e.msg,c=e.timer,d=e.type||d),b.ds.ds(b.extend(e,{msg:a,timer:c||0===c?c:b.dsOption.defaultTimer,type:d}),{title:"",selfDestroy:!0,dsType:"popup"})},b.ds.alert=function(a,c,d,e,f,g){g=b.isPlainObject(a)?b.extend({},a):g||{},g.uid=(new Date).getTime(),a=g.msg||a,c=g.wrap||c,d=g.timer||d,e=g.type||e||"info",f=g.method||f,c[f||"after"]('<div id="alert-unit-'+g.uid+'" class="ds-pd ds-alert ds-alert-'+e+'">'+(g.noTypeIcon?"":b.dsOption.typeHtml[e])+a+(g.noCloseBtn?"":'<span class="ds-pointer ds-alert-close">&times;</span>')+"</div>"),g.noCloseBtn||b("#alert-unit-"+g.uid).on("click",".ds-alert-close",function(){b("#alert-unit-"+g.uid).remove()}),d&&!g.noCloseBtn&&setTimeout(function(){b("#alert-unit-"+g.uid).remove()},d)},b.ds.info=function(a,c,d){return b.ds.popup(a,c,"info",d)},b.ds.warn=function(a,c,d){return b.ds.popup(a,c,"warn",d)},b.ds.error=function(a,c,d){return b.ds.popup(a,c,"error",d)},b.ds.ok=function(a,c,d){return b.ds.popup(a,c,"ok",d)},b.ds.dialog=function(a){return a=a||{},a.title=a.title?a.title:b.dsOption.defaultTitle,b.ds.ds(a,{dsType:"dialog"})},b.ds.confirm=function(a){return a=a||{},a.title=a.title?a.title:b.dsOption.defaultTitle,b.ds.ds(a,{dsType:"dialog",selfDestroy:!0,btns:[{html:b.dsOption.defaultConfirmBtnHtml,callback:function(){this.hide.call(this),a.confirmCallback.call(this,!0)}},{html:b.dsOption.defaultCancelBtnHtml,callback:function(){this.hide.call(this),a.confirmCallback.call(this,!1)}}]})},b.ds.right=function(a,c,e,f){b.isPlainObject(a)?(f=a,a=f.msg,c=f.timer,e=f.type):f={};var g=(b.dsOption,"id"+(new Date).getTime(),0),h=0,i=d(a,e,f.btns);return g=i.cw,h=i.ch,b.ds.ds(b.extend({hasCloseBtn:!1},f,{msg:a,timer:c||0===c?c:b.dsOption.defaultTimer,type:e}),{title:"",modal:!1,selfDestroy:!0,css:{right:-g,left:"auto",position:"fixed",top:f.top||b.dsOption.defaultTop,width:"auto"},animateSpeed:400,show:"animate",showParam:{right:0},hide:"animate",hideParam:{right:-g},dsType:"right"})},b.ds.left=function(a,c,e,f){b.isPlainObject(a)?(f=a,a=f.msg,c=f.timer,e=f.type):f={};var g=(b.dsOption,"id"+(new Date).getTime(),0),h=0,i=d(a,e,f.btns);return g=i.cw,h=i.ch,b.ds.ds(b.extend({hasCloseBtn:!1},f,{msg:a,timer:c||0===c?c:b.dsOption.defaultTimer,type:e}),{title:"",animateSpeed:400,modal:!1,selfDestroy:!0,css:{right:"auto",left:-g,position:"fixed",top:f.top||40,width:"auto"},show:"animate",showParam:{left:0},hide:"animate",hideParam:{left:-g},dsType:"left"})},b.ds.top=function(a,c,e,f){b.isPlainObject(a)?(f=a,a=f.msg,c=f.timer,e=f.type):f={};var g=(b.dsOption,"id"+(new Date).getTime(),0),h=0,i=d(a,e,f.btns);return g=i.cw,h=i.ch,b.ds.ds(b.extend({hasCloseBtn:!1},f,{msg:a,timer:c||0===c?c:b.dsOption.defaultTimer,type:e}),{title:"",animateSpeed:400,modal:!1,selfDestroy:!0,css:{top:-h,left:"50%",right:"auto","margin-left":-(g/2),position:"fixed",width:"auto"},show:"animate",showParam:{top:0},hide:"animate",hideParam:{top:-h},dsType:"top"})}}"function"==typeof define?define(function(require){b(require("jquery"))}):b(jQuery)}(this);